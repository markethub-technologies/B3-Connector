<!-- HTML header for doxygen 1.14.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=11"/>
  <meta name="generator" content="Doxygen 1.14.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>OnixS C++ B3 Binary UMDF Market Data Handler: Setting Up Order Book Pool</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="onixs-doxygen-new.css" rel="stylesheet" type="text/css"/>
</head>
<body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
  <table cellspacing="0" cellpadding="0">
   <tbody>
   <tr id="projectrow">
    <td id="projectlogo"><img alt="Logo" src="onixs.svg" width="140"  height="28"/></td>
    <td id="projectalign">
     <div id="projectname">OnixS C++ B3 Binary UMDF Market Data Handler<span id="projectnumber">&#160;1.9.0</span>
     </div>
     <div id="projectbrief">API documentation</div>
    </td>
      <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
   </tr>
   </tbody>
  </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__order-book-pool.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Setting Up Order Book Pool <div class="ingroups"><a class="el" href="group__advanced-programming.html">Advanced Programming</a></div></div></div>
</div><!--header-->
<div class="contents">
<p>To improve performance OnixS::B3::MarketData::UMDF::OrderBook instance keeps some of its internals in the preallocated memory areas (chunks).</p>
<p>The chunks are initially owned by the OnixS::B3::MarketData::UMDF::OrderBookPool object. The <span class="tt">OrderBookPool</span> object is shared between the <span class="tt">OrderBook</span>s (and can be shared between several instances of the handlers).</p>
<div class="fragment"><div class="line">    OrderBookPoolSettings orderBookPoolSettings;</div>
<div class="line">    orderBookPoolSettings.chunksAmount = channelIds.size() * 1000;</div>
<div class="line">    orderBookPoolSettings.chunkLength = 128 * 1024;</div>
<div class="line">    <span class="keyword">auto</span> orderBookPool = make_shared&lt;OrderBookPool&gt;(orderBookPoolSettings);</div>
<div class="line"> </div>
<div class="line">    handlerSettings.orderBookPool = orderBookPool.get();</div>
<div class="line">    handlerSettings.buildOrderBooks = <span class="keyword">true</span>;</div>
</div><!-- fragment --><p>When a chunk is taken from the pool, it is not shared between the other order books, so the number of the chunks must be at least equal to the number of order books. A single order book can use from 1 to 255 chunks if necessary.</p>
<p>The number of books equals the number of securities on a channel or the size of the security filter (if used).</p>
<p>Placing the order book's internals into a single chunk improves data locality and can thus improve performance, so the chunk must be sufficient to fit the book content. On the other hand, making a chunk too big can lead to excessive memory consumption.</p>
<h1 class="doxsection"><a class="anchor" id="order-book-pool-grow-policy"></a>
Grow Policy</h1>
<p>If the amount of preallocated objects specified by OnixS::B3::MarketData::UMDF::OrderBookPoolSettings is not enough to manage order books, the pool will allocate more using OnixS::B3::MarketData::UMDF::OrderBookPoolSettings::growthPolicy.</p>
<dl class="section note"><dt>Note</dt><dd>The handler fires the warning "OrderBookPool is exhausted" if additional allocations are required. The pool settings can be reconfigured on the next run to avoid them. </dd></dl>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.14.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="support">Technical Support: <a href="mailto:support@onixs.biz">support@onixs.biz</a></li>
    <li class="footer">Copyright &#169; 2025 OnixS. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
