<!-- HTML header for doxygen 1.14.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=11"/>
  <meta name="generator" content="Doxygen 1.14.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>OnixS C++ B3 Binary UMDF Market Data Handler: Solarflare ef_vi API</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <script type="text/javascript" src="clipboard.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
  <script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link href="onixs-doxygen-new.css" rel="stylesheet" type="text/css"/>
</head>
<body>
  <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
  <div id="titlearea">
  <table cellspacing="0" cellpadding="0">
   <tbody>
   <tr id="projectrow">
    <td id="projectlogo"><img alt="Logo" src="onixs.svg" width="140"  height="28"/></td>
    <td id="projectalign">
     <div id="projectname">OnixS C++ B3 Binary UMDF Market Data Handler<span id="projectnumber">&#160;1.9.0</span>
     </div>
     <div id="projectbrief">API documentation</div>
    </td>
      <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
   </tr>
   </tbody>
  </table>
  </div>
  <!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__feed-engine-efvi.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Solarflare ef_vi API <div class="ingroups"><a class="el" href="group__advanced-programming.html">Advanced Programming</a></div></div></div>
</div><!--header-->
<div class="contents">
<p>The ef_vi API is a layer 2 API that grants an application direct access to the Solarflare network adapter datapath to deliver lower latency and reduced per message processing overheads. ef_vi is the internal API used by Onload for sending and receiving packets. It can be used directly by applications that want the very lowest latency send and receive API and that do not require a POSIX socket interface.</p>
<h1 class="doxsection"><a class="anchor" id="multithreading-efvi"></a>
Multithreading</h1>
<p>By default, the handler uses a single dedicated thread for its operation. However, if multiple handlers are needed, the number of threads will equal the number of handlers, which may degrade performance. To address this, OnixS::B3::MarketData::UMDF::FeedEngineThreadPool is provided.</p>
<div class="fragment"><div class="line">        EfViFeedEngine feedEngine;</div>
<div class="line">        FeedEngineThreadPoolSettings feedEngineThreadPoolSettings;</div>
<div class="line">        feedEngineThreadPoolSettings.threadCount(THREAD_COUNT);</div>
<div class="line">        FeedEngineThreadPool pool(feedEngineThreadPoolSettings, &amp;feedEngine);</div>
<div class="line"> </div>
<div class="line">        handlerSettings1.feedEngine = &amp;feedEngine;</div>
<div class="line">        handlerSettings2.feedEngine = &amp;feedEngine;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> handler1 = make_shared&lt;Handler&gt;(handlerSettings1);</div>
<div class="line">        <span class="keyword">auto</span> handler2 = make_shared&lt;Handler&gt;(handlerSettings1);</div>
<div class="line"> </div>
<div class="line">        handler1-&gt;start();</div>
<div class="line">        handler2-&gt;start();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// processing listener&#39;s events</span></div>
<div class="line"> </div>
<div class="line">        handler1-&gt;stop(<span class="keyword">true</span>);</div>
<div class="line">        handler2-&gt;stop(<span class="keyword">true</span>);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__all-channels-sample.html">All Channels Sample</a>;</li>
</ul>
</dd></dl>
<h1 class="doxsection"><a class="anchor" id="singlethreading"></a>
Single Thread</h1>
<p>To minimize the number of threads, the same thread can be used for both creating the handler instance and processing market data.</p>
<div class="fragment"><div class="line">        SingleThreadedEfViFeedEngine feedEngine(feLoggerSettings, NETWORK_INTEFACE);</div>
<div class="line"> </div>
<div class="line">        handlerSettings1.feedEngine = &amp;feedEngine;</div>
<div class="line">        handlerSettings2.feedEngine = &amp;feedEngine;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> handler1 = make_shared&lt;Handler&gt;(handlerSettings1);</div>
<div class="line">        <span class="keyword">auto</span> handler2 = make_shared&lt;Handler&gt;(handlerSettings1);</div>
<div class="line"> </div>
<div class="line">        handler1-&gt;start();</div>
<div class="line">        handler2-&gt;start();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// processing listener&#39;s events</span></div>
<div class="line">            process(feedEngine);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        handler1-&gt;stop(<span class="keyword">true</span>);</div>
<div class="line">        handler1-&gt;stop(<span class="keyword">true</span>);</div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><ul>
<li><a class="el" href="group__benchmark-sample.html">Benchmark Sample</a>;</li>
</ul>
</dd></dl>
<h1 class="doxsection"><a class="anchor" id="feed-engine-for-feed"></a>
Feed Engine for a Feed</h1>
<p>If a different network interface is used for incremental packets, a separate instance of OnixS::B3::MarketData::UMDF::SingleThreadedEfViFeedEngine can be used for the corresponding feed.</p>
<div class="fragment"><div class="line">        SingleThreadedEfViFeedEngine feedEngine(feLoggerSettings, NETWORK_INTEFACE);</div>
<div class="line">        SingleThreadedEfViFeedEngine feedEngineForIncrementalA(feLoggerSettings, NETWORK_INTEFACE_FOR_INCREMENTAL_A);</div>
<div class="line"> </div>
<div class="line">        handlerSettings.feedEngine = &amp;feedEngine;</div>
<div class="line">        handlerSettings.incrementalFeeds.a.feedEngine = &amp;feedEngineForIncrementalA;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> handler = make_shared&lt;Handler&gt;(handlerSettings);</div>
<div class="line"> </div>
<div class="line">        handler-&gt;start();</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// processing listener&#39;s events</span></div>
<div class="line">            process(feedEngine, feedEngineForIncrementalA);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        handler-&gt;stop(<span class="keyword">true</span>);</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.14.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="support">Technical Support: <a href="mailto:support@onixs.biz">support@onixs.biz</a></li>
    <li class="footer">Copyright &#169; 2025 OnixS. All Rights Reserved.</li>
  </ul>
</div>
</body>
</html>
